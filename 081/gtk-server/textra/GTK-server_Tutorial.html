<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="content-type"
 content="text/html; charset=utf8">
  <title>GTKサーバのチュートリアル</title>
  <meta name="author" content="Peter van Eerten">
</head>
<body>
<h1>The GTK-server Tutorial:a&quot;Hello world&quot;application.(GTKサーバー・チュートリアル:「Hello world」アプリケーション)</h1>
<h2>内容:</h2>
          <a href="#introduction">はじめに。</a>
          <br>
          <a href="#chapter1">第1章環境の設定</a>
          <br>
          <a href="#chapter2">第2章最初のステップ</a>
          <br>
          <a href="#chapter3">第3章GTKプログラミング-メインウィンドウ</a>
          <br>
          <a href="#chapter4">第4章GTKプログラミング-コンテナ</a>
          <br>
          <a href="#chapter5">第5章:GTKプログラミング-ラベル。</a>
          <br>
          <a href="#chapter6">第6章:GTKプログラミング-ボタン。</a>
          <br>
          <a href="#chapter7">第7章GTKプログラミング-メインループ</a>
          <br>
          <a href="#chapter8">第8章GTKプログラミング-メインウィンドウを閉じる</a>
          <br>
          <a href="#chapter9">第9章色の使用</a>
          <br>
          <a href="#chapter10">第10章TCPまたはUDPを使用したGTKサーバーへの接続</a>
          <br>
          <a href="#chapter11">第11章FIFOを使ったGTKサーバーへの接続</a>
          <br>
          <a href="#chapter12">第12章伐採</a>
          <br>
          <br>
        <hr style="width: 100%; height: 2px;">
          <a name="introduction"></a>
        <h2>はじめに。</h2>このチュートリアルでは、「Hello world!」というメッセージを含む単純なウィンドウを作成します。これを行うには、主にGNU AWKを使用します。AWKスクリプト言語の基本的な知識があることをお勧めします。AWKに精通していない場合は、次の場所にある優れたGNU AWKマニュアルを参照してください。<a
 href="http://www.gnu.org/software/gawk/manual/gawk.html">http://ww.gnu.org/software/gawk/manual/gawk.html</a>また、このチュートリアルでは、Linuxオペレーティングシステムに焦点を当てます。<br><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter1"></a>
        <h2>第1章環境の設定<br></h2>GTKサーバーの使用を開始する前に、環境変数をチェックする必要があります。このチュートリアルではAWKが主要なスクリプト言語になり、AWKスクリプトは引数stdinを使用してGTKサーバーを呼び出します。GTKウィジェットを正しく表示するには、言語環境を設定する必要があります。これは、GTKライブラリがこの設定を使用してウィジェットを表示するためです。これを行うには、変数LC_ALLを使用できます。環境変数の現在の設定を確認するには、コマンド「set」(BASH、またはCSHELLの場合は「setenv」)を使用できます。このコマンドにより、すべての変数が一覧表示されます。私のシステムでは、LC_ALLはオランダ語に設定されています。Linux BASHシェルで、次の操作を行います。<br><br style="font-family: courier new,courier,monospace;"><small><span style="font-family: courier new,courier,monospace;">エクスポートLC_ALL=nl_NL</span></small><br><br>の長さ、単位、補助線の属性を変更します。しかし、これだけではありません。また、ライブラリパスも設定する必要があります。X11R6ライブラリを指す必要があります。これは、テキスト入力ウィジェットなどを表示するために必要です。BASHシェルで、LD_LIBRARY_PATHが設定されていることを確認します。<br><br><small><span style="font-family: courier new,courier,monospace;">エクスポートLD_LIBRARY_PATH=/usr/X11R6/lib</span></small><br><br>または、この環境変数にすでに別の値が設定されている場合は、次のようになります。<br><br><small><span style="font-family: courier new,courier,monospace;">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/X11R6/lib&lt;パス></span></small><br><br>これで、シェル環境は、&#39;stdin&#39;でGTKサーバーを使用するスクリプト用に正しくセットアップされました。<br><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter2"></a>
        <h2>第2章最初のステップ<br></h2>AWKスクリプトの作成プロセス中に、GTKサーバーの構成ファイルも作成されます。GTK関数が使用されるたびに、この関数も構成ファイルで指定する必要があります。ただし、最初に、いくつかのデフォルトのAWK行をプログラムして開始しましょう。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">GTK=&quot;gtk-server-stdin&quot;のようになります。</span></small><br><br>-------------------<br><br>このコードから、最初の行(gawk)でインタプリタが呼び出されていることがわかります。次に、「#」で始まるいくつかのcommentlinesがあり、その後でBEGINルールが定義され、最後に変数GTKがstdin引数を持つGTKサーバーとして宣言されます。スクリプトと同じディレクトリにGTKサーバーバイナリを置く必要はありません。GTKサーバーは、「/usr/local/etc」および「/etc」ディレクトリで構成ファイルを検索します。構成ファイルがそこで使用できない場合、サーバーは終了します。<br><br>ここで、GTKサーバの使用を開始する前に、configfileを定義する必要があります。このファイルの名前は&quot;GTK-server.cfg&quot;である必要があります。定義する必要のある設定タイプは3つあります。最初のタイプは&quot;LIB_NAME&quot;です。GTKライブラリの実際の共有オブジェクト名を指定する必要があります。ほとんどの場合、これは&quot;libgtk-1.2.so&quot;または&quot;libgtk-x11-2.0.so&quot;のようになります。したがって、configfileの最初のエントリは次のようになります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span></small><span
 style="font-family: courier new,courier,monospace;"><small>番号</small><br></span><br>-------------------<br><br>コンフィグファイルでも「#」を使用できるので、コメントを付けることができます。次に使用する設定はFUNCTION_NAMEです。GTKライブラリを使用するには、最初に初期化する必要があります。これはGTK関数「gtk_init」を使用して行われます。次に、この関数をコンフィグファイルに次のように配置します。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span></small><span
 style="font-family: courier new,courier,monospace;"><small>#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULL#</small><br></span><br>-------------------<br><br>GTK関数の名前の横に、さらに定義が表示されます。最初に&#39;NONE&#39;が定義されます。この最初のNONEは、コールバック・シグナルを定義します。コールバック・シグナルは、マウスでボタンをクリックしたときなどに発生します。ただし、GTKライブラリの初期化には、それ自体のコールバック・シグナルはありません。2番目のNONEは、&quot;gtk_init&quot;関数の戻り値を定義します。これは、この関数に戻り値がないことを意味します。次に、数値&#39;2&#39;は、&quot;gtk_init&quot;関数の引数の数を定義します。最後に、最後の2つの定義は、引数のタイプを指定します。&#39;NULL&#39;が定義されている場合は、引数に特定のタイプがないことを意味します。<br><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter3"></a>
        <h2>第3章GTKプログラミング-メインウィンドウ</h2>さて、ここまでは順調です!AWKスクリプトから始めて、gtk-server.cfgファイルの最初のセットアップを行います。次に、実際のプログラミングに進み、「gtk_init」をAWKスクリプトに追加します。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"></small><span style="font-family: courier new,courier,monospace;"><small>GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline</small><br></span><br>-------------------<br><br>&#39;print&#39;で始まる行は、実際にはGTKサーバーへの2方向パイプを作成します。これは真のAWKテクニックです。パイプ演算子「&amp;」はKSHから借用されました。プレーンデータを送受信できる通信チャネルを設定します。ご覧のように、AWKスクリプトはGTK関数名をプレーンテキストとしてサーバーに送信し、その後サーバーは情報を返信します。<br><br>これは覚えておくべき重要なことです:情報がGTKサーバに送信されるたびに、サーバは情報を送り返します!GTK関数に戻り値がない場合(&quot;gtk_init&quot;など)、サーバは単純な&quot;ok&quot;をスクリプトに返します。GTK関数が認識されなかった場合、サーバは&quot;-1&quot;を返します。GTKサーバは常に文字列を返すことに注意してください。<br><br>これで、メインウィンドウを作成する準備ができました。使用するGTK関数は&quot;gtk_window_new&quot;と呼ばれます。ただし、この関数は、作成されたウィンドウを参照する識別子を返します。GTK関数がウィジェットの識別子を返す場合、これはconfigfileでWIDGETとして定義されている必要があります。ただし、この関数にはCの型定義である&quot;GtkWindowType&quot;引数があります。これをconfigfileで説明するにはどうすればよいですか。<br><br>C typedefinitionsは少しトリッキーです。GTK typedefinitionsはたくさんあり、これらすべてをGTKサーバで定義するのは非常に冗長です。しかし、Cプログラム言語はtypedefinitionsに内部整数の番号付けを使用します。「GtkWindowType」のtypedefinitionsを見ると、GTK_WINDOW_TOPLEVELとGTK_WINDOW_POPUPの2つのタイプが定義されています。ここで、C言語は最初のタイプを&#39;0&#39;で、2番目のタイプを&#39;1&#39;で参照します。これらは通常の整数です。その場合、&quot;gtk_window_new&quot;の引数タイプをLONGとして定義できます。gtkサーバのコンフィグファイルは次のようになります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,NONE,WIDGET,1,LONG</span><br></small><span style="font-family: courier new,courier,monospace;"><small>番号</small><br></span><br>-------------------<br><br>ウィンドウのコールバックシグナルはまだ定義しません。では、AWKスクリプトに移動しましょう。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"></small><span style="font-family: courier new,courier,monospace;"><small>GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW</small><br></span><br>-------------------<br><br>GTK関数の戻り値が変数&quot;WINDOW&quot;に取り込まれていることがわかります。後で、この変数を使用してウィンドウでアクションを実行できます。今すぐ実行しましょう。ウィンドウのタイトルバーに名前を定義しましょう。このためのGTK関数は&quot;gtk_window_set_title&quot;と呼ばれています。戻り値はなく、タイトルを設定するウィンドウとタイトル自体の2つの引数を使用します。これが現在のコンフィグファイルです。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,NONE,WIDGET,1,LONG FUNCTION_NAME=gtk_window_set_title,NONE,NONE,2,WIDGET,STRING</span></small><span
 style="font-family: courier new,courier,monospace;"><small>番号</small><br></span><br>-------------------<br><br>AWKスクリプトは次のようになります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"></small><span style="font-family: courier new,courier,monospace;"><small>GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getline</small><br></span><br>-------------------<br><br>簡単でしょ?<br><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter4"></a>
        <h2>第4章GTKプログラミング-コンテナ</h2>元のGTKの原則に従って、ウィジェットをパックするためのコンテナを定義する必要があります。ウィンドウをコンテナとして定義することは可能ですが、個人的にはテーブルを使用する方が好きです。テーブルが定義されている場合、関係座標を使用してウィジェットを簡単に定義できます。ウィンドウにテーブルを作成するには、関数「gtk_table_new」を使用する必要があります。この関数はウィジェットを返し、3つの引数を使用します(テーブルにはコールバック信号を使用しません)。最初の2つの引数は、テーブル内の行と列の数を決定します。3番目の引数はブール引数です。これを回避するには、typedefinitionsに対して行ったのと同じトリックを使用します。「false」には「0」、「true」には「1」を使用します。<br><br>また、テーブルはウィンドウに釘付けにする必要があります。これは&quot;gtk_container_add&quot;で行います。この関数は2つの引数を使用します。もう1つのウィジェット(Table)が釘付けにされるウィジェット(Window)です。これでコンフィグファイルは次のようになります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,NONE,WIDGET,1,LONG FUNCTION_NAME=gtk_window_set_title,NONE,NONE,2,WIDGET,STRING</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_table_new,NONE,WIDGET,3,LONG,LONG,LONG FUNCTION_NAME=gtk_container_add,NONE,NONE,2,WIDGET,WIDGET</span></small><span
 style="font-family: courier new,courier,monospace;"><small>番号</small><br></span><br>-------------------<br><br>AWKスクリプトを次に示します。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"></small><span style="font-family: courier new,courier,monospace;"><small>GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_table_new 30 30 1&quot;&amp;GTK;GTK&amp;getline TABLE print&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE&amp;GTK;GTK&amp;getline</small><br></span><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter5"></a>
        <h2>第5章:GTKプログラミング-ラベル。</h2>次に、「Hello world」というメッセージがウィンドウに表示されます。ラベルを定義する必要があります。これには、非常に便利なGTK関数「gtk_label_new」があります。この関数には、表示するテキストを含む引数が1つだけあります。<br><br>ただし、このウィジェットはテーブルに「パック」される必要があります。「gtk_table_attach_defaults」関数を使用します。最初の引数は使用するテーブルを決定し、2番目の引数はパックするウィジェットを決定し、次に(テーブルに関連する)左x座標と右x座標が指定され、最後に上下のy座標が指定されます。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,NONE,WIDGET,1,LONG FUNCTION_NAME=gtk_window_set_title,NONE,NONE,2,WIDGET,STRING</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_table_new,NONE,WIDGET,3,LONG,LONG,LONG FUNCTION_NAME=gtk_container_add,NONE,NONE,2,WIDGET,WIDGET FUNCTION_NAME=gtk_label_new,NONE,WIDGET,1,STRING FUNCTION_NAME=gtk_table_attach_defaults,NONE,NONE,6,WIDGET,WIDGET,LONG,LONG,LONG,LONG</span></small><span
 style="font-family: courier new,courier,monospace;"><small>番号</small><br></span><br>-------------------<br><br>AWKスクリプト:<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"></small><span style="font-family: courier new,courier,monospace;"><small>GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_table_new 30 30 1&quot;&amp;GTK;GTK&amp;getline TABLE print&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE&amp;GTK;GTK&amp;getline print&quot;gtk_label_new\&quot;Hello world\&quot;&quot;&amp;GTK;GTK&amp;getline LABEL print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;LABEL&quot;1 29 3 7&quot;&amp;GTK;GTK&amp;getline</small><br></span><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter6"></a>
        <h2>第6章:GTKプログラミング-ボタン。</h2>「Exit」ボタンも作成します。このボタンをクリックすると、「Hello world」アプリケーションが終了します。AWKスクリプトが終了できるように、クリック信号をキャプチャする必要があります。GTK関数「gtk_button_new_with_label」はボタンを作成し、その上にテキストを配置します。ただし、「click」信号をキャプチャする必要があることは明らかです。<br><br>さて、ウィジェットを作成する準備ができました。最後に、すべてのウィジェットは世界に表示される必要があります。これは、GTK関数「gtk_widget_show」によって実現されます。この関数は、1つの引数、つまり表示されるウィジェットのみを取ります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,NONE,WIDGET,1,LONG FUNCTION_NAME=gtk_window_set_title,NONE,NONE,2,WIDGET,STRING</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_table_new,NONE,WIDGET,3,LONG,LONG,LONG FUNCTION_NAME=gtk_container_add,NONE,NONE,2,WIDGET,WIDGET FUNCTION_NAME=gtk_label_new,NONE,WIDGET,1,STRING FUNCTION_NAME=gtk_table_attach_defaults,NONE,NONE,6,WIDGET,WIDGET,LONG,LONG,LONG,LONG FUNCTION_NAME=gtk_button_new_with_label,clicked,WIDGET,1,STRING FUNCTION_NAME=gtk_widget_show,NONE,NONE,1,WIDGET</span><span style="font-family: courier new,courier,monospace;"></span></small><br>-------------------<br><br>そのため、ボタンは識別子を返し、ボタンに出力されるテキストを含む1つの引数を持ちます。コールバックシグナルは&quot;clicked&quot;として定義されています。GTKドキュメントでは、ボタンから出力されるすべてのシグナルが記述されています。&quot;clicked&quot;という用語は、&quot;click&quot;シグナルを表す実際のGTK用語です。ウィンドウにボタンを配置して表示しましょう。TABLEコンテナも表示する必要があることに注意してください。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_table_new 30 30 1&quot;&amp;GTK;GTK&amp;getline TABLE print&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE&amp;GTK;GTK&amp;getline print&quot;gtk_label_new\&quot;Hello world\&quot;&quot;&amp;GTK;GTK&amp;getline LABEL print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;LABEL&quot;1 29 3 7&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_button_new_with_label終了&quot;&amp;GTK;GTK&amp;getline BUTTON print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;BUTTON&quot;20 28 23 27&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;LABEL&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;BUTTON&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;TABLE&amp;GTK;GTK&amp;getline</span><br></small><span style="font-family: courier new,courier,monospace;"><small>print&quot;gtk_widget_show&quot;ウィンドウ&amp;GTK;GTK&amp;getline</small><br></span><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter7"></a>
        <h2>第7章GTKプログラミング-メインループ</h2>最後のステージ、メインループの定義に入ります。GTKでは、すべてのGTKイベントを一度に実行することができます。これは、GTK関数&quot;gtk_main_iteration&quot;によって実行されます。このイテレーションでは、GTKライブラリはイベントが発生したかどうかをチェックします。プログラムでは、「click」シグナルがボタンによって発行されたかどうかをチェックします。最後のconfigfileとAWKプログラムの下:<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,NONE,WIDGET,1,LONG FUNCTION_NAME=gtk_window_set_title,NONE,NONE,2,WIDGET,STRING</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_table_new,NONE,WIDGET,3,LONG,LONG,LONG FUNCTION_NAME=gtk_container_add,NONE,NONE,2,WIDGET,WIDGET FUNCTION_NAME=gtk_label_new,NONE,WIDGET,1,STRING FUNCTION_NAME=gtk_table_attach_defaults,NONE,NONE,6,WIDGET,WIDGET,LONG,LONG,LONG,LONG FUNCTION_NAME=gtk_button_new_with_label,clicked,WIDGET,1,STRING FUNCTION_NAME=gtk_widget_show,NONE,NONE,1,WIDGET FUNCTION_NAME=gtk_main_iteration,NONE,WIDGET,0</span></small><span
 style="font-family: courier new,courier,monospace;"><small></small></span><br>-------------------<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_table_new 30 30 1&quot;&amp;GTK;GTK&amp;getline TABLE print&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE&amp;GTK;GTK&amp;getline print&quot;gtk_label_new\&quot;Hello world\&quot;&quot;&amp;GTK;GTK&amp;getline LABEL print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;LABEL&quot;1 29 3 7&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_button_new_with_label終了&quot;&amp;GTK;GTK&amp;getline BUTTON print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;BUTTON&quot;20 28 23 27&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;LABEL&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;BUTTON&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;TABLE&amp;GTK;GTK&amp;getline</span><br></small><span style="font-family: courier new,courier,monospace;"><small>print&quot;gtk_widget_show&quot;WINDOW&amp;GTK;GTK&amp;getline EVENT=0 do{print&quot;gtk_main_iteration&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_server_callback 0&quot;&amp;GTK;GTK&amp;getline EVENT}while(EVENT!=BUTTON)close(GTK)fflush(&quot;&quot;)}を実行します。</small><br></span><br>-------------------<br><br>メインループを詳しく見てみましょう。コンフィグファイルにGTK関数&quot;gtk_main_iteration&quot;を定義しました。この関数は、GTKイベントによってトリガされて1回実行され、それに応じてすべてのGTKウィジェットを更新します。しかし、関数&quot;gtk_server_callback&quot;がコンフィグファイルに見つかりません。なぜですか?これはGTKサーバーの内部関数であるためです。GTKライブラリから最後に発生したシグナルを取得しました。シグナルが発生した場合、GTKサーバーはウィジェットIDを返します。それ以外の場合は&#39;0&#39;が返されます。上記のAWKスクリプトでは、戻り値は変数に取り込まれ、メインループの&#39;while&#39;でチェックされます。<br><br>メインループが閉じると、GTKサーバーへの2方向パイプも閉じられます。最後に、すべてのAWKバッファがフラッシュされます。<br><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter8"></a>
        <h2>第8章GTKプログラミング-メインウィンドウを閉じる</h2>ウィンドウマネージャの通常の終了機能を使用してウィンドウを閉じることができない場合があります。Windowsでは、ウィンドウの右上にある十字を使用することはできません。ただし、メインウィンドウから送信された&#39;delete&#39;シグナルはAWKスクリプトに取り込まれないため、これは完全に問題ありません。<br><br>通常の方法(EXITボタンを使用しない)でウィンドウを閉じるには、メインウィンドウにコールバックシグナルを定義する必要があります。ウィンドウを閉じようとするときのシグナルの名前は「delete-event」です。コンフィグファイルを次のように変更する必要があります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,delete-event,WIDGET,1,LONG FUNCTION_NAME=gtk_window_set_title,NONE,NONE,2,WIDGET,STRING</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_table_new,NONE,WIDGET,3,LONG,LONG,LONG FUNCTION_NAME=gtk_container_add,NONE,NONE,2,WIDGET,WIDGET FUNCTION_NAME=gtk_label_new,NONE,WIDGET,1,STRING FUNCTION_NAME=gtk_table_attach_defaults,NONE,NONE,6,WIDGET,WIDGET,LONG,LONG,LONG,LONG FUNCTION_NAME=gtk_button_new_with_label,CLICK,WIDGET,1,STRING FUNCTION_NAME=gtk_widget_show,NONE,NONE,1,WIDGET FUNCTION_NAME=gtk_main_iteration,NONE,WIDGET,0</span><span style="font-family: courier new,courier,monospace;"></span></small><small><span
 style="font-family: courier new,courier,monospace;"></span></small><small><span
 style="font-family: courier new,courier,monospace;"></span><span
 style="font-family: courier new,courier,monospace;"></span></small><br>-------------------<br><br>ご覧のように、GTK関数&quot;gtk_window_new&quot;はコールバックシグナル&quot;delete-event&quot;で再定義されています。GTKシグナルに大文字を使用しないように注意してください。<br><br>ここでAWKスクリプトを実行すると、メインウィンドウは「delete-event」シグナルをリッスンします。ただし、アプリケーションを実際に終了するには、メインループも変更する必要があります。これを行う方法については、次のように提案します。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_table_new 30 30 1&quot;&amp;GTK;GTK&amp;getline TABLE print&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE&amp;GTK;GTK&amp;getline print&quot;gtk_label_new\&quot;Hello world\&quot;&quot;&amp;GTK;GTK&amp;getline LABEL print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;LABEL&quot;1 29 3 7&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_button_new_with_label終了&quot;&amp;GTK;GTK&amp;getline BUTTON print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;BUTTON&quot;20 28 23 27&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;LABEL&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;BUTTON&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;TABLE&amp;GTK;GTK&amp;getline</span><br><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;ウィンドウ&amp;GTK;GTK&amp;getline EVENT=0</span></small><small><span
 style="font-family: courier new,courier,monospace;">do{print&quot;gtk_main_iteration&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_server_callback 0&quot;&amp;GTK;GTK&amp;getline EVENT</span></small><small><span style="font-family: courier new,courier,monospace;">:}while(EVENT!=BUTTON&amp;&amp;EVENT!=WINDOW)close(GTK)fflush(&quot;&quot;)}</span></small><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter9"></a>
        <h2>第9章色の使用</h2>アプリケーションで色を使用することもできます。ウィジェットの色付けはGTKではなくGDKのためなので、これは奇妙に思えるかもしれません。しかし、GTKサーバでは、ウィジェットの色付けにGTKコマンドを使用できます。<br><br>この例では、ボタンに色を付けてみましょう。まず、このウィジェットに特定の名前を付ける必要があります。「exitbutton」という名前を付けましょう。名前を設定したら、スクリプトは色の定義を含む外部ファイルを読み取る必要があります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">GTK=&quot;gtk-server-stdin&quot;print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_table_new 30 30 1&quot;&amp;GTK;GTK&amp;getline TABLE print&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE&amp;GTK;GTK&amp;getline print&quot;gtk_label_new\&quot;Hello world\&quot;&quot;&amp;GTK;GTK&amp;getline LABEL print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;LABEL&quot;1 29 3 7&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_button_new_with_label終了&quot;&amp;GTK;GTK&amp;getline BUTTON print&quot;gtk_widget_set_name&quot;BUTTON&quot;exitbutton&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;BUTTON&quot;20 28 23 27&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_rc_parse gtkrc&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;LABEL&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;BUTTON&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;TABLE&amp;GTK;GTK&amp;getline</span><br><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;ウィンドウ&amp;GTK;GTK&amp;getline EVENT=0</span></small><small><span
 style="font-family: courier new,courier,monospace;">do{print&quot;gtk_main_iteration&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_server_callback 0&quot;&amp;GTK;GTK&amp;getline EVENT</span></small><br><small><span style="font-family: courier new,courier,monospace;">:}while(EVENT!=BUTTON&amp;&amp;EVENT!=WINDOW)close(GTK)fflush(&quot;&quot;)}</span></small><br><br>-------------------<br><br>コマンドを見るとわかるように<small><span
 style="font-family: courier new,courier,monospace;">gtk_widget_set_name(gtk_widget_set_</span></small>および<small><span
 style="font-family: courier new,courier,monospace;">gtk_rc_parse(英語の可能性あり)</span></small>が使用されます。最初のコマンドは名前を設定し、2番目のコマンドはcolordefinitionsを読み取ります。もちろん、これらのコマンドはconfigfileでも使用できます。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#LIB_NAME=libgtk-x11-2.0.soのようになります。</span><span style="font-family: courier new,courier,monospace;">#FUNCTION_NAME=gtk_init,NONE,NONE,2,NULL,NULLの場合</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_window_new,delete-event,WIDGET,1,LONG FUNCTION_NAME=gtk_window_set_title,NONE,NONE,2,WIDGET,STRING</span><span style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_table_new,NONE,WIDGET,3,LONG,LONG,LONG FUNCTION_NAME=gtk_container_add,NONE,NONE,2,WIDGET,WIDGET FUNCTION_NAME=gtk_label_new,NONE,WIDGET,1,STRING FUNCTION_NAME=gtk_table_attach_defaults,NONE,NONE,6,WIDGET,WIDGET,LONG,LONG,LONG,LONG FUNCTION_NAME=gtk_button_new_with_label,CLICK,WIDGET,1,STRING</span></small><span style="font-family: courier new,courier,monospace;"><small></small></span><small><span
 style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_widget_show,NONE,NONE,1,WIDGET FUNCTION_NAME=gtk_main_iteration,NONE,WIDGET,0</span></small><span style="font-family: courier new,courier,monospace;"><span
 style="font-family: courier new,courier,monospace;">FUNCTION_NAME=gtk_widget_set_name,NONE,NONE,2,WIDGET,STRING FUNCTION_NAME=gtk_rc_parse,NONE,NONE,1,STRING</span></span><small><span
 style="font-family: courier new,courier,monospace;"></span></small><small><span
 style="font-family: courier new,courier,monospace;"></span><span
 style="font-family: courier new,courier,monospace;"></span></small><br>-------------------<br><br>次に、ボタンのcolordefintionsを含む「gtkrc」というファイルを作成する必要があります。このファイルはスクリプトと同じディレクトリにあり、次のようになります。<br><br>-------------------<br><br><span style="font-family: courier new,courier,monospace;"><small>style&quot;mystyle&quot;{bg[NORMAL]={65535,0,0}bg[PRELIGHT]={40000,40000,40000}bg[ACTIVE]={0,65535,0}}ウィジェット&quot;*.*.exitbutton*&quot;style&quot;mystyle&quot;</small></span><br><br>-------------------<br><br>この場合も、コマンド<span
 style="font-family: courier new,courier,monospace;"><small>gtk_rc_parse(英語の可能性あり)</small></span>ファイルを読み込み、「exitbutton」という名前のウィジェットを指定された色に設定します。ここでは、色はRGBトリプレットとして定義されます。ボタンが通常の状態のとき、色は赤になります。ボタンが押されたとき、色は緑になります。最後に、マウスがボタンの上に移動すると、色はグレーになります。<br><br>GTK rcファイルを使用すると、ウィジェットのセット全体を特定の色に着色するなど、さらに多くの可能性があります。GTKのマニュアルを参照してください。<a
 href="http://www.gtk.org">http://www.gtk.org</a>で詳細な説明を参照してください。<br><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter10"></a>
        <h2>第10章TCPまたはUDPを使用したGTKサーバーへの接続</h2>2-wayパイプを使用する代わりに、TCPまたはUDPでスクリプトを接続することもできます。<br><br>TCPソケットを使用してGTKサーバを起動するには、サーバへの引数は&lt;tcp=ipaddress:port>の形式である必要があります。UDPでは、形式はほぼ同じ&lt;udp=ipaddress:port>です。<br><br>次に例を示します。<br><br><span style="font-family: courier new,courier,monospace;"><small>gtk-server-tcp=localhost:50000と入力します。</small></span><br><br>これでサーバが起動し、ローカルホストのIPアドレス(127.0.0.1)をリッスンします。スクリプトはTCPポート50000に接続する必要があります。「Hello world」アプリケーションをTCP接続に書き直すと、スクリプトは次のようになります。<br><br>-------------------<br><br><small><span style="font-family: courier new,courier,monospace;">#!/usr/bin/gawk-fと入力します。</span><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">#AWK GTKを使用したHello worldアプリケーション</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">番号</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">開始{</span><br
 style="font-family: courier new,courier,monospace;"><br style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">システム(&quot;gtk-server-tcp=localhost:50000&amp;&quot;)</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">GTK=&quot;/inet/tcp/0/localhost/50000&quot;</span><br
 style="font-family: courier new,courier,monospace;"><span style="font-family: courier new,courier,monospace;">print&quot;gtk_init NULL NULL&quot;&amp;GTK;GTK&amp;getlineprint&quot;gtk_window_new 0&quot;&amp;GTK;GTK&amp;getline WINDOW print&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;&amp;GTK;GTK&amp;getlineprint&quot;gtk_table_new 30 30 1&quot;&amp;GTK;GTK&amp;getline TABLE print&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE&amp;GTK;GTK&amp;getlineprint&quot;gtk_label_new\&quot;Hello world\&quot;&quot;&amp;GTK;GTK&amp;getline LABEL print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;LABEL&quot;1 29 3 7&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_button_new_with_label終了&quot;&amp;GTK;GTK&amp;getline BUTTON print&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;BUTTON&quot;20 28 23 27&quot;&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;LABEL&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;BUTTON&amp;GTK;GTK&amp;getline</span><span style="font-family: courier new,courier,monospace;">print&quot;gtk_widget_show&quot;TABLE&amp;GTK;GTK&amp;getline</span><br></small><span style="font-family: courier new,courier,monospace;"><small>print&quot;gtk_widget_show&quot;ウィンドウ&amp;GTK;GTK&amp;getline EVENT=0</small></span><span style="font-family: courier new,courier,monospace;"><small>do{print&quot;gtk_main_iteration&quot;&amp;GTK;GTK&amp;getline print&quot;gtk_server_callback 0&quot;&amp;GTK;GTK&amp;getline EVENT</small></span><span style="font-family: courier new,courier,monospace;"><small>:}while(EVENT!=BUTTON&amp;&amp;EVENT!=WINDOW)close(GTK)fflush(&quot;&quot;)}</small><br></span><br>-------------------<br><br>バージョン3.1では、GNU AWKスクリプト言語にネットワークサポートが組み込まれています。上記のスクリプトは、TCPポートを使用してAWKをサーバーに接続します。AWKインタープリターが高速で実行されることがあります。したがって、GTKサーバーの起動後、GTKサーバーが初期化されるまでに1秒間待つ必要があります。<br><br>最後に、(UDPではなく)TCPを使用して複数のスクリプトを1 GTKサーバに接続できます。この方法では、GTKサーバの複数のインスタンスをメモリ内で実行することを回避でき、それぞれがTCPポートを消費します。(Windows OSはフォークをサポートしていないため、この機能はWindows環境では使用できません。)この機能を有効にするには、次のようにGTKサーバを起動します。<br><br><small><span style="font-family: courier new,courier,monospace;">gtk-server-tcp localhost:50000:16&lt;ホスト名></span></small><br><br>数値&#39;16&#39;は、GTKサーバを同時に使用できるクライアントスクリプトの最大数を定義します。ここでは任意の数値を使用できます(最大数はOSとハードウェアによって異なります)。起動時にこの方法でGTKサーバを起動するのは良い考えです。GTKサーバがバックグラウンドで永続的に実行されるように、この処理を行う「rc」スクリプトを作成できます。必要に応じて、どのスクリプトもTCPで接続できるため、常にGTK GUIにアクセスできます。<br><br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter11"></a>
        <h2>第11章FIFOを使ったGTKサーバーへの接続</h2>最後に、名前付きパイプを使用してGTKサーバーに接続できます。名前付きパイプは特別な機能を持つファイルで、他のプロセスやプログラムにメッセージを配信できます。パイプに配信された最初のメッセージは、他の側で最初に読み取られます。その逆も同様です。したがって、FIFOという略語は、実際には「先入れ先出し」を意味します。<br><br>FIFOパイプを使用してGTKサーバを起動するには、サーバへの引数をfifo=&lt;name>にする必要があります。GTKサーバは、ファイル名&lt;name>を持つ名前付きパイプ(実際にはハードディスク上のファイル)を作成します。<br><br>次に例を示します。<br><br><span style="font-family: courier new,courier,monospace;"><small>gtk-server-fifo=mypipe&lt;パス></small></span><br><br>Windowsでは、構文が異なります。GTKサーバーは2つの独立した名前付きパイプを作成します。これらもファイルのように動作します。名前付きパイプには事前に定義された名前があるため、指定する必要はありません。Windowsで名前付きパイプを使用してGTKサーバーを起動するには、次のように入力します。<br><br><span style="font-family: courier new,courier,monospace;"><small>gtk-サーバ-fifo</small></span><br><br>ここで、クライアントスクリプトは、まず名前付きパイプ&quot;\\.\pipe\out&quot;を開き、次に名前付きパイプ&quot;\\.\pipe\in&quot;を開く必要があります。前述のように、これらのパイプの名前は事前に定義されています。また、パイプを開く順序も重要です!最初に「out」パイプを開く必要があります。これは、クライアントスクリプトが情報を書き込むために使用されます。「in」パイプは、情報を読み取るために使用されます。<br><br>AWKプログラムを続けましょう。名前付きパイプを使用するには、AWKプログラムを少し調整する必要があります。名前付きパイプがファイルのように動作することはすでに明らかです。したがって、通信を可能にするには、このファイルを読み書きする必要があります。AWKでは、プログラムは次のようになります。<br><br><small><span style="font-family: courier new,courier,monospace;">function GTK(call){print call>>&quot;mypipe&quot;close(&quot;mypipe&quot;,&quot;to&quot;)getline&lt;&quot;mypipe&quot;close(&quot;mypipe&quot;,&quot;from&quot;)return$0}#--------------------------------------BEGIN{system(&quot;gtk-server-fifo=mypipe&amp;&quot;)GTK(&quot;gtk_init NULL NULL&quot;)WINDOW=GTK(&quot;gtk_window_new 0&quot;)GTK(&quot;gtk_window_set_title&quot;WINDOW&quot;\&quot;This is a title\&quot;&quot;)TABLE=GTK(&quot;gtk_table_new 30 30 1&quot;)GTK(&quot;gtk_container_add&quot;WINDOW&quot;&quot;TABLE)LABEL=GTK(&quot;gtk_label_new\&quot;Hello world\&quot;&quot;)GTK(&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;LABEL&quot;1 29 3 7&quot;)BUTTON=GTK(&quot;gtk_button_new_with_label Exit&quot;)GTK(&quot;gtk_table_attach_defaults&quot;TABLE&quot;&quot;BUTTON&quot;20 28 23 27&quot;)GTK(&quot;gtk_widget_show_all&quot;WINDOW)EVENT=0 do{EVENT=GTK(&quot;gtk_server_callback WAIT&quot;)}while(EVENT!=BUTTON&amp;&amp;EVENT!=WINDOW)print&quot;gtk_server_exit&quot;>>&quot;gtk&quot;}</span></small><br>ご覧のように、プログラムの構造が変更されました。通信部分は現在、別の関数(「GTK」と呼ばれる)に置かれています。この関数内の2つの「close」文は、AWKがIOバッファをフラッシュできるようにするために必要です。<br><br>また、GTK関数&quot;gtk_widget_show_all&quot;は、各GTKウィジェットを個別に表示するのではなく、親ウィジェットWINDOWとそれに関連付けられたすべての子ウィジェットを表示します。この新しい関数をconfigfileに入れるのを忘れないでください!これで、この関数の定義方法がわかったはずです。<br><br>メインループが変更され、&#39;gtk_server_callback&#39;関数の引数が&#39;WAIT&#39;になりました。これは、前の&#39;gtk_main_iteration&#39;を継承します。したがって、コールバック関数はイベントが発生するまで待機します。シグナルを発行したウィジェットIDとともにAWKプログラムに戻ります。<br><br>最後に、GTKライブラリーは、GTKサーバーからの応答を待つことなく、単純な&#39;gtk_server_exit&#39;をパイプに出力することによって終了します。<br><br><hr style="width: 100%; height: 2px;">
          <a name="chapter12"></a>
        <h2>第12章伐採</h2>GTKプログラミング中に問題が発生した場合は、GTKサーバが受信した文字列を確認すると便利です。また、入力に対するGTKサーバの応答を確認することもできます。幸い、GTKサーバはログファイルを作成できます。GTKサーバのロギング機能を有効にするには、次のように起動します。<br><br><small><span style="font-family: courier new,courier,monospace;">gtk-server-stdin-log=log.txt&lt;ファイル名></span></small><br><br>または<br><small><br><span style="font-family: courier new,courier,monospace;">gtk-server-tcp=localhost:50000-log=mylog.txt&amp;&lt;パス></span></small><br><br>または<br><small><br><span style="font-family: courier new,courier,monospace;">gtk-server-fifo=mypipe-log=program.logおよび</span></small><br><br>最後の引数&#39;log&#39;は、GTKサーバをロギングモードにします。ロギングは指定されたファイルにリダイレクトされます。<br><br>さて、それはそれです。あなたは今、GTKのグルです。あなたのスクリプトをguifyに行ってください!<br><br><hr style="width: 100%; height: 2px;"><br>(c)2003年12月～2004年10月、Peter van Eerten-http://www.gtk-server.org/<br><br>2006年7月第2版-PvE。<br>2008年12月第3版-PvE。<br><br><hr style="width: 100%; height: 2px;">
</body>
</html>
