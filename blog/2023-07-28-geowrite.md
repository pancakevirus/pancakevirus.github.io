# 2023年7月28日

GeoWorks は RISC OS や Ring にでも移植したほうが良さそうだな。結局、 GEOS は保守コストを考えるとすべて書き直しになるから頭が痛くなるね。あきらめて [PipeDream](https://croftnuisk.co.uk/coltsoft/pipedream) でもと魔剣マガサス(ステンレス鋼)ですね。

## GeoWrite

使われている API や ESP のディレクティブなど調べておきたいので、ちょっと読み始めます。といってもナンモワカラン。翻訳始めた頃を思い出すなあ。ま、そんなものです。

### 8086 / 80186 命令

特に変なのはない。たぶん他のプロセッサとの移植性なんて多少は考えていたのだろう(もともとC64出身のソフトだけど)。
後で洗い出して書き直します(※は80186命令などなど)。

Esp のディレクティブは i386 に対応しているようだけど、 opcodes.h あたりを眺める限りは使えるのかは不明です。

命令セット参考: https://en.wikipedia.org/wiki/X86_instruction_listings

```
add, dec, and, not, or, rcr, shr
call, ret, retn
cmp, jc, jcxz, jz, jnz, je, jne
test,
lahf, sahf
mov, lea, push, pop, inc, sub, 
repe, stc
```

以下は未調査

```
uses,　cmpdw
pushf, popf
local,
ja, je, jle
proc,
loop,
clr,
ornf
movdw,
mul
endm
```

ユーザ定義マクロ命令 ([geos.def](
https://github.com/bluewaysw/pcgeos/blob/9672d033f192a4fd5103103bf385cc8cd58c48b7/Include/geos.def))

80186以降でなければ正常に動作しません。たしか、8086で80186のソフトウェアエミュレーションを行うものがあったと記憶していますが。これがGEOSで使えるかは不明です (8086搭載機ならばV30に換装してしまうのでしょうけど)

```
mov_tr, segmov, tst
```

### ライブラリ

定義については write.gp あたりを参照のこと。ライブラリのソースコードは Library ディレクトリにある(geos ライブラリだけどこにあるか不明...)

完全移植するなら GeoWriteよりライブラリのほうが解析は手間かもしれない。いやさ、フルアセンブラだぜ。

### わかんないよ。
本当に。ただ、いままでの翻訳経験なんかを応用しているだけ。

* 単語の抽出(出現頻度)
* 意味や機能の調査
* 概念の理解
* 自然言語への翻訳

プログラミングとは逆のことをしている。


